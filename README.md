## Руководство пользователя

Подробная информация о работе алгоритма [тут](data)

**Системные требования:** 4 Гб свободной памяти на диске, Python.

Данная программа предназначена для формирования сметы по изображению электрической схемы.

## Запуск программы
1. Скачайте проект;
2. Для запуска программы необходимо установить все зависимости. Для этого в командной строке/терминале перейдите в каталог проекта (далее все команды выполняются в терминале); 
3. Введите команду `python -m venv venv` в терминале (в корне проекта создается окружение, в котором будут устанавливаться все необходимые зависимости);
4. Активируйте виртуальное окружение Python командой: `.\venv\Scripts\activate`;
5. Установите зависимости командой `pip install -r requirements.txt`;
6. Установка зависимостей занимает несколько минут, далее введите `python main.py`. Программа активирована, должно появиться окно.

> При возникновении проблемы с доступом внутри терминала VS Code, зайдите в консоль PowerShell и введите команду Set-ExecutionPolicy –ExecutionPolicy RemoteSigned

## Работа в программе 

Для загрузки изображения схемы используйте элемент меню ***Файл -> открыть*** или кликните по левой части приложения (виджет для работы с изображениями).
После выбора изображения происходит автоматическое выделение распознанных объектов и соответствующих им блоков текста. 
*Далее происходит проверка пользователем корректности разметки схемы* 
Все найденные объекты приведены в таблице вида:
 
| Артикул | Номенклатура | Стоимость | Количество | Общая стоимость
|:-----------:|:--------:|:----------:|:---------:|:---------:|
|     mcb10-2-04B-av      |     Выключатель автоматический    |      2322.5472     |      1     |2322.5472|
|     ...     |    ...   |     ...    |    ...       |    ...     |

Если были выделены не все объекты на изображении, пользватель может вручную разметить недостающие элементы. Данные изменения отобразятся в смете - таблице справа. 

## Функицонал программы 

### Перемещение по изображению
* Для перемещения по изображению импользуйте кнопку ***{ЛКМ}*** 
* Для приближения используйте колесо мыши

### Разметка блоков
* Для разметки на изображении объектов необходимо зажать ***{ПКМ}*** и выделить нужную область 
* Затем в появившимся окне выберите класс объекта, нажмите ***{OK}*** для добавления или ***{Cancel}*** для отмены

### Загрузка изображения
Левое окно предназначено для визуализации изображения, есть 3 способа его загрузки: 
* Кликнуть на само окно, после чего появится окно выбора файла;
* Перейти в меню "File" -> "Open scheme image" и выбрать изображение;
* Использовать горячие клавиши "Ctrl+O".

Поддерживаемые форматы файлов: .PDF, .JPG, .PNG.

### Работа с изображением
После загрузки изображения сразу выполняется детектирование с помощью **YOLO** и на экране вы видите 
полностью размеченное изображение. Если алгоритм выполнил детекцию не всех элементов, то можно самостоятельно 
доразметить оставшиеся элементы. Действия:  
* Размечать дополнительные элементы: приблизить и выделить область с помощью правой кнопки мыши (ПКМ);
* Удалять размеченные элементы: кликнуть ПКМ по области элемента и нажать "Backspace".

### Анализ изображения
Когда все необходимые элементы размечены, нажмите кнопку "Analyze". Формирование таблицы происходит в течение нескольких секунд, после обработки данных 
в правой части появится таблица с распознанными элементами.

### Редактирование таблицы
Таблицу можно редактировать:
* Добавить новую строчку: нажмите кнопку "Add a new element";
* Удалить выбранные строчки: выделите строчку, кликнув на цифру в начале строки, и нажмите "Delete selected".

### Экспорт данных - формирование сметы
После внесения всех изменений в таблицу:
1. Перейдите в "File" -> "Export".
2. Выберите формат сохраняемого файла: Excel, CSV, или оба формата.
3. Подтвердите выбор, через несколько секунд файл будет сохранен.
Файл появляется внутри корневого каталога проекта.

### Завершение работы
* Для выбора нового файла можно повторить процесс загрузки;
* Для закрытия программы используйте горячую клавишу "Alt-Q".
